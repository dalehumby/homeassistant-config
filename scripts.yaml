apple_tv_spotify_launch:
  alias: Launch Spotify on Apple TV
  mode: restart
  sequence:
    service: remote.send_command
    target:
      entity_id: remote.apple_tv
    data:
      delay_secs: 1
      command:
        - top_menu
        - home
        - right
        - right
        - right
        - select

apple_tv_spotify_nowplaying:
  alias: Show Spotify Now Playing on Apple TV
  mode: restart
  sequence:
    service: remote.send_command
    target:
      entity_id: remote.apple_tv
    data:
      delay_secs: 1
      command:
        - down
        - menu
        - right
        - right
        - right
        - right
        - select

tv_sleep:
  alias: Turn off Apple TV and Samsung TV
  icon: mdi:power-sleep
  mode: restart
  sequence:
    - service: remote.send_command
      target:
        entity_id: remote.apple_tv
      data:
        delay_secs: 1
        command:
          - home_hold
          - select
    - service: media_player.turn_off
      target:
        entity_id:
          - media_player.apple_tv
          - media_player.spotify_dale
    - service: switch.turn_off
      target:
        entity_id: switch.samsung_tv

tv_wake:
  alias: Turn on Apple TV and Samsung TV
  icon: mdi:power-standby
  mode: restart
  sequence:
    - service: switch.turn_on
      target:
        entity_id: switch.samsung_tv
    - service: media_player.turn_on
      target:
        entity_id:
          - media_player.apple_tv
          - media_player.spotify_dale
    - service: remote.turn_on
      target:
        entity_id: remote.apple_tv
    - wait_template: "{{ is_state('media_player.apple_tv', 'idle') }}"
      continue_on_timeout: true
      timeout: 5
    - wait_template: "{{ is_state('remote.apple_tv', 'on') }}"
      continue_on_timeout: true
      timeout: 5
    - service: remote.send_command
      target:
        entity_id: remote.apple_tv
      data:
        delay_secs: 1
        command:
          - wakeup
          - home

apple_tv_spotify_play:
  alias: Play Spotify Daily Mix
  icon: mdi:spotify
  mode: restart
  sequence:
    - service: script.tv_wake
    - service: script.apple_tv_spotify_launch
    - delay: 6
    - service: media_player.select_source
      target:
        entity_id: media_player.spotify_dale
      data:
        source: Living Room
    - delay: 2
    - service: media_player.play_media
      target:
        entity_id: media_player.spotify_dale
      data_template:
        media_content_id: "{{ states('sensor.daily_playlist') }}"
        media_content_type: playlist
    - delay: 2
    - service: script.apple_tv_spotify_nowplaying

laundry_timer_start:
  alias: Laundry timer
  icon: mdi:washing-machine
  mode: restart
  sequence:
    - service: timer.start
      target:
        entity_id: timer.laundry

dale_charge_phone:
  alias: Dale charge phone
  icon: mdi:sleep
  mode: restart
  sequence:
    - condition:
      - condition: state
        entity_id: person.dale
        state: "home"
      - condition: time
        after: "21:30:00"
      - condition: state
        entity_id: light.bedside_lights
        state: "on"
    - service: scene.turn_on
      target:
        entity_id: scene.goodnight
      data:
        transition: 5
